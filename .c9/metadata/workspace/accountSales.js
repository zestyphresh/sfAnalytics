{"filter":false,"title":"accountSales.js","tooltip":"/accountSales.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":13,"column":34},"end":{"row":13,"column":35},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":35},"end":{"row":13,"column":36},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":36},"end":{"row":13,"column":37},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":37},"end":{"row":13,"column":38},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":38},"end":{"row":13,"column":39},"action":"insert","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":39},"end":{"row":13,"column":40},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":40},"end":{"row":13,"column":41},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":41},"end":{"row":13,"column":42},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":42},"end":{"row":13,"column":43},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":43},"end":{"row":13,"column":44},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":44},"end":{"row":13,"column":45},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":45},"end":{"row":13,"column":46},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":47},"end":{"row":13,"column":48},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":16,"column":39},"action":"remove","lines":["        ","        sales.loadRecords(resSales);","        forecast.loadRecords(resSales);"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":19,"column":24},"action":"remove","lines":["        value.totalSales();","        value.totalVolumes();","        chart.salesperson();","        chart.weekly();","        table.product();"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":3},"end":{"row":207,"column":4},"action":"remove","lines":[" ","    value.totalSales = function() {","        ","        var data = dims.dummy.group().reduceSum(function(d) { return d.Value__c; }).top(1)[0];","        console.log(data);","        ","        $j('#headline-value').text(accounting.formatMoney(data.value, \"£\", 0, \",\", \".\"));","        ","    };","    ","    value.totalVolumes = function() {","        ","        var data = dims.dummy.group().reduceSum(function(d) { return d.Quantity__c; }).top(1)[0];","        console.log(data);","        ","        $j('#headline-volume').text(accounting.formatNumber(data.value, 0, \",\", \".\"));","        ","    };","        ","    chart.salesperson = function() {","        ","        var data = _.sortBy(groups.salespersonValue.top(Infinity), function(d) { return d.value; });","        console.log(data);","","        var chart = d4.charts.row()","            .outerHeight($j('#chart-salesperson').height())","            .outerWidth($j('#chart-salesperson').width())","            .margin({ top: 10, right: 50, bottom: 20, left: 140 })","            .x(function(x){","                x.key('value');","            })","            .y(function(y){","                y.key('key');","            })","            .valueKey('value')","            .mixout(['xAxis'])","            .using('barLabels', function(labels) {","                labels.text(function(d) {","                    return accounting.formatMoney(d.value, \"£\", 0, \",\", \".\")","                })","            })","        ;","","        d3.select('#chart-salesperson')","            .datum(data)","            .call(chart)","        ;","","    };","    ","    chart.weekly = function() {","        ","        var data = _.sortBy(groups.weeklyValue.orderNatural().top(Infinity), function(d) { return d.key.toDate(); });","        ","        ","        _.each(data, function(d) { d.key = d.key.format('MMM DD'); });","        ","        console.log(data);","","        var chart = d4.charts.column()","            .outerHeight($j('#chart-weekly').height())","            .outerWidth($j('#chart-weekly').width())","            .margin({ top: 10, right: 10, bottom: 20, left: 20 })","            .x(function(x){","                x.key('key');","            })","            .y(function(y){","                y.key('value');","            })","            .valueKey('value')","            .mixout('yAxis')","            .using('barLabels', function(labels) {","                labels.text(function(d) {","                    return accounting.formatMoney(d.value, \"£\", 0, \",\", \".\")","                })","            })","        ;","        ","        var datum = [{ key: 'sales', values: data }]","        ","        d3.select('#chart-weekly')","            .datum(data)","            .call(chart)","        ;","           ","    };","    ","    table.product = function() {","        ","        var data = _.sortBy(groups.productMatrix.top(Infinity), function(d) { return d.value.total; });","        console.log(data);","      ","        var _columns = [{\"data\": \"key\", \"title\": \"Product\"},","                        {\"data\": \"value.total\", \"title\": \"Total\"},","                        {\"data\": \"value.SteveGent\", \"title\": \"SG\"},","                        {\"data\": \"value.MarkPugh\", \"title\": \"MP\"}, ","                        {\"data\": \"value.BrianMurphy\", \"title\": \"BM\"},                ","                        {\"data\": \"value.StevenHooper\", \"title\": \"SH\"},                    ","                        {\"data\": \"value.TracyBoorman\", \"title\": \"TB\"},                ","                        {\"data\": \"value.PhilLacy\", \"title\": \"PL\"},                      ","                        {\"data\": \"value.BrianRobertson\", \"title\": \"BR\"},        ","                        {\"data\": \"value.NorrieCurrie\", \"title\": \"NC\"},","                        {\"data\": \"value.MatthewKettleborough\", \"title\": \"MK\"}","        ];","","        var table = $j('#table-matrix').dataTable({","            'data' : data,","            'paging' : true,","            'order': [[ 1, 'desc' ]],","            'dom' : 'ftip',","            'columns' : _columns,","            'columnDefs' : [","                { \"width\": \"40%\", \"targets\": 0 }","            ]","        });","        ","    };","","    cf.reduce = {};","    cf.reduce.productMatrix = {","        ","        reduceAdd : function (p, v) {","","            p.count++;","            p.total += v.Quantity__c;","            p[v.Salesperson__r.Name.replace(/\\s/g, \"\")] += v.Quantity__c;","            return p;","                ","        },","        ","        reduceSubtract : function (p, v) {","                ","            p.count--;","            p.total -= v.Quantity__c;","            p[v.Salesperson__r.Name.replace(/\\s/g, \"\")] -= v.Quantity__c;","            return p;","                ","        },","            ","        reduceInit : function () {","            return {'count' : 0, 'total' : 0, 'SteveGent' : 0, 'MarkPugh' : 0, 'BrianMurphy': 0, 'StevenHooper': 0, 'TracyBoorman': 0, ","                    'PhilLacy' : 0, 'BrianRobertson': 0, 'NorrieCurrie': 0, 'MatthewKettleborough': 0};","        }","    };   ","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":0},"end":{"row":63,"column":3},"action":"remove","lines":["    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","   "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":0},"end":{"row":53,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":29},"end":{"row":63,"column":30},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":64,"column":28},"end":{"row":64,"column":29},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":24},"end":{"row":63,"column":25},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":64,"column":23},"end":{"row":64,"column":24},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":9},"end":{"row":88,"column":14},"action":"remove","lines":["promo"]},{"start":{"row":88,"column":9},"end":{"row":88,"column":10},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":10},"end":{"row":88,"column":11},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":11},"end":{"row":88,"column":12},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":12},"end":{"row":88,"column":13},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":13},"end":{"row":88,"column":14},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":19},"end":{"row":9,"column":0},"action":"insert","lines":["",""]},{"start":{"row":9,"column":0},"end":{"row":9,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":4},"end":{"row":9,"column":5},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":5},"end":{"row":9,"column":6},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":6},"end":{"row":9,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":7},"end":{"row":9,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":8},"end":{"row":9,"column":9},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":9},"end":{"row":9,"column":10},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":10},"end":{"row":9,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":11},"end":{"row":9,"column":12},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":12},"end":{"row":9,"column":13},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":13},"end":{"row":9,"column":14},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":15},"end":{"row":9,"column":16},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":16},"end":{"row":9,"column":17},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":17},"end":{"row":9,"column":18},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":18},"end":{"row":9,"column":19},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":0},"end":{"row":55,"column":19},"action":"remove","lines":["    var utils = {};"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":0},"end":{"row":56,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":0},"end":{"row":56,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":13},"end":{"row":55,"column":14},"action":"insert","lines":["R"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":14},"end":{"row":55,"column":15},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":15},"end":{"row":55,"column":16},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":16},"end":{"row":55,"column":17},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":17},"end":{"row":55,"column":18},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":18},"end":{"row":55,"column":19},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":19},"end":{"row":55,"column":20},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":4},"end":{"row":54,"column":22},"action":"remove","lines":["//Common Functions"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":4},"end":{"row":54,"column":5},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":5},"end":{"row":54,"column":6},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":6},"end":{"row":54,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":7},"end":{"row":54,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":8},"end":{"row":54,"column":9},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":9},"end":{"row":54,"column":10},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":10},"end":{"row":54,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":11},"end":{"row":54,"column":12},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":12},"end":{"row":54,"column":13},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":13},"end":{"row":54,"column":14},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":14},"end":{"row":54,"column":15},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":15},"end":{"row":54,"column":16},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":16},"end":{"row":54,"column":17},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":4},"end":{"row":55,"column":10},"action":"remove","lines":["utils."]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":4},"end":{"row":55,"column":8},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":19},"end":{"row":55,"column":20},"action":"remove","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":19},"end":{"row":55,"column":20},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":54,"column":17},"end":{"row":55,"column":0},"action":"insert","lines":["",""]},{"start":{"row":55,"column":0},"end":{"row":55,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":0},"end":{"row":58,"column":4},"action":"insert","lines":["    "]},{"start":{"row":59,"column":0},"end":{"row":59,"column":4},"action":"insert","lines":["    "]},{"start":{"row":60,"column":0},"end":{"row":60,"column":4},"action":"insert","lines":["    "]},{"start":{"row":61,"column":0},"end":{"row":61,"column":4},"action":"insert","lines":["    "]},{"start":{"row":62,"column":0},"end":{"row":62,"column":4},"action":"insert","lines":["    "]},{"start":{"row":63,"column":0},"end":{"row":63,"column":4},"action":"insert","lines":["    "]},{"start":{"row":64,"column":0},"end":{"row":64,"column":4},"action":"insert","lines":["    "]},{"start":{"row":65,"column":0},"end":{"row":65,"column":4},"action":"insert","lines":["    "]},{"start":{"row":66,"column":0},"end":{"row":66,"column":4},"action":"insert","lines":["    "]},{"start":{"row":67,"column":0},"end":{"row":67,"column":4},"action":"insert","lines":["    "]},{"start":{"row":68,"column":0},"end":{"row":68,"column":4},"action":"insert","lines":["    "]},{"start":{"row":69,"column":0},"end":{"row":69,"column":4},"action":"insert","lines":["    "]},{"start":{"row":70,"column":0},"end":{"row":70,"column":4},"action":"insert","lines":["    "]},{"start":{"row":71,"column":0},"end":{"row":71,"column":4},"action":"insert","lines":["    "]},{"start":{"row":72,"column":0},"end":{"row":72,"column":4},"action":"insert","lines":["    "]},{"start":{"row":73,"column":0},"end":{"row":73,"column":4},"action":"insert","lines":["    "]},{"start":{"row":74,"column":0},"end":{"row":74,"column":4},"action":"insert","lines":["    "]},{"start":{"row":75,"column":0},"end":{"row":75,"column":4},"action":"insert","lines":["    "]},{"start":{"row":76,"column":0},"end":{"row":76,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":4},"end":{"row":78,"column":8},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":9},"end":{"row":78,"column":10},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":9},"end":{"row":78,"column":10},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":9},"end":{"row":80,"column":10},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":8},"end":{"row":80,"column":9},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":7},"end":{"row":80,"column":8},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":6},"end":{"row":80,"column":7},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":5},"end":{"row":80,"column":6},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":4},"end":{"row":80,"column":5},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":4},"end":{"row":80,"column":8},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":13},"end":{"row":80,"column":14},"action":"remove","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":13},"end":{"row":80,"column":14},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":8},"end":{"row":82,"column":12},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":4},"end":{"row":84,"column":8},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":9},"end":{"row":84,"column":10},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":9},"end":{"row":85,"column":0},"action":"insert","lines":["",""]},{"start":{"row":85,"column":0},"end":{"row":85,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":4},"end":{"row":85,"column":8},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":4},"end":{"row":85,"column":5},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":9},"end":{"row":85,"column":0},"action":"insert","lines":["",""]},{"start":{"row":85,"column":0},"end":{"row":85,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":56,"column":11},"end":{"row":56,"column":18},"action":"remove","lines":["Records"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":9,"column":19},"action":"remove","lines":["    var utils = {};"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":19},"end":{"row":9,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":16,"column":4},"end":{"row":16,"column":4},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1423833938255,"hash":"b6cd29fd505bdbed8cf901b31a8ca6dbc6488dd1"}
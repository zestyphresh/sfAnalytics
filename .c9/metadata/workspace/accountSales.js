{"filter":false,"title":"accountSales.js","tooltip":"/accountSales.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":12,"column":26},"end":{"row":12,"column":27},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":27},"end":{"row":12,"column":28},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":28},"end":{"row":12,"column":29},"action":"insert","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":29},"end":{"row":12,"column":30},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":30},"end":{"row":12,"column":31},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":31},"end":{"row":12,"column":32},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":32},"end":{"row":12,"column":33},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":32},"end":{"row":12,"column":33},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":31},"end":{"row":12,"column":32},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":30},"end":{"row":12,"column":31},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":29},"end":{"row":12,"column":30},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":28},"end":{"row":12,"column":29},"action":"remove","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":27},"end":{"row":12,"column":28},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":26},"end":{"row":12,"column":27},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":25},"end":{"row":12,"column":26},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":25},"end":{"row":12,"column":26},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":26},"end":{"row":12,"column":27},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":27},"end":{"row":12,"column":28},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":28},"end":{"row":12,"column":29},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":29},"end":{"row":12,"column":30},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":29},"end":{"row":12,"column":30},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":29},"end":{"row":12,"column":30},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":30},"end":{"row":12,"column":31},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":31},"end":{"row":12,"column":32},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":20},"end":{"row":10,"column":25},"action":"remove","lines":["apply"]},{"start":{"row":10,"column":20},"end":{"row":10,"column":21},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":21},"end":{"row":10,"column":22},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":22},"end":{"row":10,"column":23},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":23},"end":{"row":10,"column":24},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":43},"end":{"row":10,"column":48},"action":"remove","lines":["apply"]},{"start":{"row":10,"column":43},"end":{"row":10,"column":44},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":44},"end":{"row":10,"column":45},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":45},"end":{"row":10,"column":46},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":46},"end":{"row":10,"column":47},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":32},"end":{"row":12,"column":33},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":33},"end":{"row":12,"column":34},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":34},"end":{"row":12,"column":35},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":35},"end":{"row":12,"column":36},"action":"insert","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":36},"end":{"row":12,"column":37},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":37},"end":{"row":12,"column":38},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":38},"end":{"row":12,"column":39},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":39},"end":{"row":12,"column":40},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":41},"end":{"row":12,"column":42},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":42},"end":{"row":13,"column":0},"action":"insert","lines":["",""]},{"start":{"row":13,"column":0},"end":{"row":13,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":8},"end":{"row":13,"column":9},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":9},"end":{"row":13,"column":10},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":10},"end":{"row":13,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":11},"end":{"row":13,"column":12},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":12},"end":{"row":13,"column":13},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":13},"end":{"row":13,"column":14},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":14},"end":{"row":13,"column":15},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":15},"end":{"row":13,"column":16},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":16},"end":{"row":13,"column":17},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":17},"end":{"row":13,"column":18},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":18},"end":{"row":13,"column":19},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":19},"end":{"row":13,"column":20},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":20},"end":{"row":13,"column":21},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":21},"end":{"row":13,"column":22},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":22},"end":{"row":13,"column":23},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":23},"end":{"row":13,"column":24},"action":"insert","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":24},"end":{"row":13,"column":26},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":25},"end":{"row":13,"column":26},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":26},"end":{"row":13,"column":27},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":27},"end":{"row":13,"column":28},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":28},"end":{"row":13,"column":29},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":29},"end":{"row":13,"column":30},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":30},"end":{"row":13,"column":31},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":31},"end":{"row":13,"column":32},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":32},"end":{"row":13,"column":33},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":33},"end":{"row":13,"column":34},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":34},"end":{"row":13,"column":35},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":35},"end":{"row":13,"column":36},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":36},"end":{"row":13,"column":37},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":37},"end":{"row":13,"column":38},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":38},"end":{"row":13,"column":39},"action":"insert","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":39},"end":{"row":13,"column":40},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":40},"end":{"row":13,"column":41},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":41},"end":{"row":13,"column":42},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":42},"end":{"row":13,"column":43},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":43},"end":{"row":13,"column":44},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":44},"end":{"row":13,"column":45},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":45},"end":{"row":13,"column":46},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":47},"end":{"row":13,"column":48},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":48},"end":{"row":14,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":16,"column":39},"action":"remove","lines":["        ","        sales.loadRecords(resSales);","        forecast.loadRecords(resSales);"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":19,"column":24},"action":"remove","lines":["        value.totalSales();","        value.totalVolumes();","        chart.salesperson();","        chart.weekly();","        table.product();"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":3},"end":{"row":207,"column":4},"action":"remove","lines":[" ","    value.totalSales = function() {","        ","        var data = dims.dummy.group().reduceSum(function(d) { return d.Value__c; }).top(1)[0];","        console.log(data);","        ","        $j('#headline-value').text(accounting.formatMoney(data.value, \"£\", 0, \",\", \".\"));","        ","    };","    ","    value.totalVolumes = function() {","        ","        var data = dims.dummy.group().reduceSum(function(d) { return d.Quantity__c; }).top(1)[0];","        console.log(data);","        ","        $j('#headline-volume').text(accounting.formatNumber(data.value, 0, \",\", \".\"));","        ","    };","        ","    chart.salesperson = function() {","        ","        var data = _.sortBy(groups.salespersonValue.top(Infinity), function(d) { return d.value; });","        console.log(data);","","        var chart = d4.charts.row()","            .outerHeight($j('#chart-salesperson').height())","            .outerWidth($j('#chart-salesperson').width())","            .margin({ top: 10, right: 50, bottom: 20, left: 140 })","            .x(function(x){","                x.key('value');","            })","            .y(function(y){","                y.key('key');","            })","            .valueKey('value')","            .mixout(['xAxis'])","            .using('barLabels', function(labels) {","                labels.text(function(d) {","                    return accounting.formatMoney(d.value, \"£\", 0, \",\", \".\")","                })","            })","        ;","","        d3.select('#chart-salesperson')","            .datum(data)","            .call(chart)","        ;","","    };","    ","    chart.weekly = function() {","        ","        var data = _.sortBy(groups.weeklyValue.orderNatural().top(Infinity), function(d) { return d.key.toDate(); });","        ","        ","        _.each(data, function(d) { d.key = d.key.format('MMM DD'); });","        ","        console.log(data);","","        var chart = d4.charts.column()","            .outerHeight($j('#chart-weekly').height())","            .outerWidth($j('#chart-weekly').width())","            .margin({ top: 10, right: 10, bottom: 20, left: 20 })","            .x(function(x){","                x.key('key');","            })","            .y(function(y){","                y.key('value');","            })","            .valueKey('value')","            .mixout('yAxis')","            .using('barLabels', function(labels) {","                labels.text(function(d) {","                    return accounting.formatMoney(d.value, \"£\", 0, \",\", \".\")","                })","            })","        ;","        ","        var datum = [{ key: 'sales', values: data }]","        ","        d3.select('#chart-weekly')","            .datum(data)","            .call(chart)","        ;","           ","    };","    ","    table.product = function() {","        ","        var data = _.sortBy(groups.productMatrix.top(Infinity), function(d) { return d.value.total; });","        console.log(data);","      ","        var _columns = [{\"data\": \"key\", \"title\": \"Product\"},","                        {\"data\": \"value.total\", \"title\": \"Total\"},","                        {\"data\": \"value.SteveGent\", \"title\": \"SG\"},","                        {\"data\": \"value.MarkPugh\", \"title\": \"MP\"}, ","                        {\"data\": \"value.BrianMurphy\", \"title\": \"BM\"},                ","                        {\"data\": \"value.StevenHooper\", \"title\": \"SH\"},                    ","                        {\"data\": \"value.TracyBoorman\", \"title\": \"TB\"},                ","                        {\"data\": \"value.PhilLacy\", \"title\": \"PL\"},                      ","                        {\"data\": \"value.BrianRobertson\", \"title\": \"BR\"},        ","                        {\"data\": \"value.NorrieCurrie\", \"title\": \"NC\"},","                        {\"data\": \"value.MatthewKettleborough\", \"title\": \"MK\"}","        ];","","        var table = $j('#table-matrix').dataTable({","            'data' : data,","            'paging' : true,","            'order': [[ 1, 'desc' ]],","            'dom' : 'ftip',","            'columns' : _columns,","            'columnDefs' : [","                { \"width\": \"40%\", \"targets\": 0 }","            ]","        });","        ","    };","","    cf.reduce = {};","    cf.reduce.productMatrix = {","        ","        reduceAdd : function (p, v) {","","            p.count++;","            p.total += v.Quantity__c;","            p[v.Salesperson__r.Name.replace(/\\s/g, \"\")] += v.Quantity__c;","            return p;","                ","        },","        ","        reduceSubtract : function (p, v) {","                ","            p.count--;","            p.total -= v.Quantity__c;","            p[v.Salesperson__r.Name.replace(/\\s/g, \"\")] -= v.Quantity__c;","            return p;","                ","        },","            ","        reduceInit : function () {","            return {'count' : 0, 'total' : 0, 'SteveGent' : 0, 'MarkPugh' : 0, 'BrianMurphy': 0, 'StevenHooper': 0, 'TracyBoorman': 0, ","                    'PhilLacy' : 0, 'BrianRobertson': 0, 'NorrieCurrie': 0, 'MatthewKettleborough': 0};","        }","    };   ","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":0},"end":{"row":63,"column":3},"action":"remove","lines":["    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","   "]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":0},"end":{"row":53,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":29},"end":{"row":63,"column":30},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":64,"column":28},"end":{"row":64,"column":29},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":24},"end":{"row":63,"column":25},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":64,"column":23},"end":{"row":64,"column":24},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":9},"end":{"row":88,"column":14},"action":"remove","lines":["promo"]},{"start":{"row":88,"column":9},"end":{"row":88,"column":10},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":10},"end":{"row":88,"column":11},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":11},"end":{"row":88,"column":12},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":12},"end":{"row":88,"column":13},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":13},"end":{"row":88,"column":14},"action":"insert","lines":["d"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":15,"column":14},"end":{"row":15,"column":14},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1423832870313,"hash":"b2cc26fbcd12c042b21076c9e9ec572e8340292c"}
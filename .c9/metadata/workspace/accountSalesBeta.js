{"filter":false,"title":"accountSalesBeta.js","tooltip":"/accountSalesBeta.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":69,"column":12},"end":{"row":69,"column":16},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":12},"end":{"row":69,"column":16},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":12},"end":{"row":69,"column":13},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":12},"end":{"row":69,"column":13},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":8},"end":{"row":69,"column":12},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":4},"end":{"row":69,"column":8},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":4},"end":{"row":69,"column":8},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":8},"end":{"row":70,"column":0},"action":"insert","lines":["",""]},{"start":{"row":70,"column":0},"end":{"row":70,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":8},"end":{"row":69,"column":9},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":37},"end":{"row":182,"column":42},"action":"remove","lines":[", dat"]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":27},"end":{"row":182,"column":32},"action":"insert","lines":[", dat"]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":28},"end":{"row":182,"column":29},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":27},"end":{"row":182,"column":28},"action":"remove","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":30},"end":{"row":182,"column":31},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":31},"end":{"row":182,"column":32},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":32},"end":{"row":182,"column":33},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":182,"column":43},"end":{"row":182,"column":44},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":221,"column":42},"end":{"row":221,"column":60},"action":"insert","lines":["dataSummaryByMonth"]}]}],[{"group":"doc","deltas":[{"start":{"row":222,"column":39},"end":{"row":222,"column":57},"action":"insert","lines":["dataSummaryByMonth"]}]}],[{"group":"doc","deltas":[{"start":{"row":223,"column":39},"end":{"row":223,"column":57},"action":"insert","lines":["dataSummaryByMonth"]}]}],[{"group":"doc","deltas":[{"start":{"row":224,"column":37},"end":{"row":224,"column":55},"action":"insert","lines":["dataSummaryByMonth"]}]}],[{"group":"doc","deltas":[{"start":{"row":224,"column":55},"end":{"row":224,"column":56},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":224,"column":56},"end":{"row":224,"column":57},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":221,"column":60},"end":{"row":221,"column":61},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":221,"column":61},"end":{"row":221,"column":62},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":223,"column":57},"end":{"row":223,"column":58},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":223,"column":58},"end":{"row":223,"column":59},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":222,"column":57},"end":{"row":222,"column":58},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":222,"column":58},"end":{"row":222,"column":59},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":336,"column":6},"action":"remove","lines":[" var dataTemplatebyMonth = [","        {monthName : 'January', month : 1, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'February', month : 2, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'March', month : 3, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'April', month : 4, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'May', month : 5, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'June', month : 6, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'July', month : 7, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'August', month : 8, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'September', month : 9, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'October', month : 10, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'November', month : 11, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0},","        {monthName : 'December', month : 12, credits : 0, despatches : 0, sales : 0, budget : 0, vsBudget : 0, target : 0, vsTarget : 0, last : 0, vsLast : 0}","    ];","        ","    var salesByMonthGross = function() {","        ","        var result = _.cloneDeep(dataTemplatebyMonth);","","        _.each(result, function(d) {","            d.credits = d3.sum(data.sales, function(s) { ","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear ? s.Gross_Credits__c : 0; ","            });","            d.despatches = d3.sum(data.sales, function(s) { ","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear ? s.Gross_Despatches__c : 0; ","            });","            d.sales = d3.sum(data.sales, function(s) { ","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear ? s.Value__c : 0; ","            });","            d.budget = d3.sum(data.forecast, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear && s.Forecast_Type__c == 'Budget' ? s.Gross_Value__c : 0; ","            });","            d.target = d3.sum(data.forecast, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear && (s.Forecast_Type__c == 'Budget' || s.Forecast_Type__c == 'Target')? s.Gross_Value__c : 0;","            });","            d.last = d3.sum(data.sales, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == lastYear ? s.Value__c : 0;","            });","            d.vsBudget = d.sales - d.budget;","            d.vsTarget = d.sales - d.target;","            d.vsLast = d.sales - d.last;","        });","        ","        return result;","        ","    };","    ","    var salesByMonthNet = function() {","        ","        var result = _.cloneDeep(dataTemplatebyMonth);","","        _.each(result, function(d) {","            d.credits = 0;","            d.despatches = 0;","            d.sales = d3.sum(data.sales, function(s) { ","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear ? s.Net_Value__c : 0; ","            });","            d.budget = d3.sum(data.forecast, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear && s.Forecast_Type__c == 'Budget' ? s.Net_Value__c : 0; ","            });","            d.target = d3.sum(data.forecast, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == thisYear && (s.Forecast_Type__c == 'Budget' || s.Forecast_Type__c == 'Target')? s.Net_Value__c : 0;","            });","            d.last = d3.sum(data.sales, function(s) {","                return s.Fiscal_Month__c == d.month && s.Fiscal_Year__c == lastYear ? s.Net_Value__c : 0;","            });","            d.vsBudget = d.sales - d.budget;","            d.vsTarget = d.sales - d.target;","            d.vsLast = d.sales - d.last;","        });","        ","        return result;","        ","    };","    ","    var salesByPeriod = function(source) {","        ","        //console.log('FUNCTION salesByPeriod', source);","        ","        var result = {};","        ","        //These functions can probably be shortened - d3.sum maybe doesn't lend itself when reuse is necessary","        function summaryDataTemplate(period, data, comp) {","            ","            //console.log('FUNCTION salesByPeriod summaryDataTemplate', period, data, comp);","            ","            this.period = period;","            this.credits = d3.sum(data, function(d) { return comp(d.month) ? d.credits : 0; }); ","            this.despatches = d3.sum(data, function(d) {return comp(d.month) ? d.despatches : 0; });","            this.sales = d3.sum(data, function(d) {return comp(d.month) ? d.sales : 0; });","            this.budget = d3.sum(data, function(d) {return comp(d.month) ? d.budget : 0; }); ","            this.target = d3.sum(data, function(d) {return comp(d.month) ? d.target : 0; }); ","            this.last = d3.sum(data, function(d) {return comp(d.month) ? d.last : 0; });","            this.vsBudget = this.sales - this.budget;","            this.vsTarget = this.sales - this.target; ","            this.vsLast = this.sales - this.last;","        }","        ","        result.yearToDate = new summaryDataTemplate('Year To Date', source, function(month) { return month < fiscal.PeriodNum__c; });","        result.lastPeriod = new summaryDataTemplate('Last Period', source, function(month) { return month == fiscal.PeriodNum__c - 1; });","        result.currentPeriod = new summaryDataTemplate('Current Period', source, function(month) { return month == fiscal.PeriodNum__c; });","        result.fullYear = new summaryDataTemplate('Full Year', source, function(month) { return true; });","        ","        return result;","        ","    };"]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":232,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":232,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":228,"column":5},"end":{"row":229,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":229,"column":4},"end":{"row":229,"column":8},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":229,"column":4},"end":{"row":230,"column":0},"action":"insert","lines":["",""]},{"start":{"row":230,"column":0},"end":{"row":230,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":4},"end":{"row":230,"column":5},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":5},"end":{"row":230,"column":6},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":6},"end":{"row":230,"column":7},"action":"insert","lines":["N"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":7},"end":{"row":230,"column":8},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":8},"end":{"row":230,"column":9},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":9},"end":{"row":230,"column":10},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":10},"end":{"row":230,"column":11},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":11},"end":{"row":230,"column":12},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":12},"end":{"row":230,"column":13},"action":"insert","lines":["O"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":13},"end":{"row":230,"column":14},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":14},"end":{"row":230,"column":15},"action":"insert","lines":["U"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":15},"end":{"row":230,"column":16},"action":"insert","lines":["P"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":16},"end":{"row":230,"column":17},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":17},"end":{"row":230,"column":18},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":18},"end":{"row":230,"column":19},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":19},"end":{"row":230,"column":20},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":20},"end":{"row":230,"column":21},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":21},"end":{"row":230,"column":22},"action":"insert","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":22},"end":{"row":230,"column":23},"action":"insert","lines":["H"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":23},"end":{"row":230,"column":24},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":24},"end":{"row":230,"column":25},"action":"insert","lines":["R"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":25},"end":{"row":230,"column":26},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":26},"end":{"row":230,"column":27},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":27},"end":{"row":230,"column":28},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":28},"end":{"row":230,"column":29},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":29},"end":{"row":230,"column":30},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":30},"end":{"row":230,"column":31},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":31},"end":{"row":230,"column":32},"action":"insert","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":32},"end":{"row":230,"column":33},"action":"insert","lines":["U"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":33},"end":{"row":230,"column":34},"action":"insert","lines":["N"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":34},"end":{"row":230,"column":35},"action":"insert","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":35},"end":{"row":230,"column":36},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":36},"end":{"row":230,"column":37},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":37},"end":{"row":230,"column":38},"action":"insert","lines":["O"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":38},"end":{"row":230,"column":39},"action":"insert","lines":["N"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":39},"end":{"row":230,"column":40},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":40},"end":{"row":230,"column":41},"action":"insert","lines":["B"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":41},"end":{"row":230,"column":42},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":42},"end":{"row":230,"column":43},"action":"insert","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":43},"end":{"row":230,"column":44},"action":"insert","lines":["O"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":44},"end":{"row":230,"column":45},"action":"insert","lines":["R"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":45},"end":{"row":230,"column":46},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":46},"end":{"row":230,"column":47},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":47},"end":{"row":230,"column":48},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":48},"end":{"row":230,"column":49},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":49},"end":{"row":230,"column":50},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":50},"end":{"row":230,"column":51},"action":"insert","lines":["W"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":51},"end":{"row":230,"column":52},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":52},"end":{"row":230,"column":53},"action":"insert","lines":["L"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":53},"end":{"row":230,"column":54},"action":"insert","lines":["L"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":54},"end":{"row":230,"column":55},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":55},"end":{"row":230,"column":56},"action":"insert","lines":["W"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":56},"end":{"row":230,"column":57},"action":"insert","lines":["O"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":57},"end":{"row":230,"column":58},"action":"insert","lines":["R"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":58},"end":{"row":230,"column":59},"action":"insert","lines":["K"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":59},"end":{"row":230,"column":60},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":60},"end":{"row":230,"column":61},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":61},"end":{"row":230,"column":62},"action":"insert","lines":["G"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":62},"end":{"row":230,"column":63},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":63},"end":{"row":230,"column":64},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":230,"column":64},"end":{"row":230,"column":65},"action":"insert","lines":["N"]}]}]]},"ace":{"folds":[],"scrolltop":3054,"scrollleft":0,"selection":{"start":{"row":235,"column":22},"end":{"row":235,"column":22},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":217,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1425637454542,"hash":"40376668a1a2558bbd0014e4c9a0666a76d31e8a"}